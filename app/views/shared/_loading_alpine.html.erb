<script>

  document.addEventListener('alpine:init', () => {
    Alpine.store('loading', {
      loadingModal: false,
    });
  });

  // turbo-driveの遷移前
  document.addEventListener("turbo:before-visit", () => {
    console.log('turbo:before-visit');
    // Alpine.store('loading').loadingModal = true;
  });

  // turbo通信で読み込みが終わった後の処理(turbo_framesは関係ないっぽい)
  document.addEventListener("turbo:load", () => {
    Alpine.store('loading').loadingModal = false;
    // console.log('turbo:load');
  });

  // フォーム送信開始時
  //これを設定してるとturbo-flame系のものまでonになってしまう。@clickで手動で設定していった方が良いかもしれない。
  // document.addEventListener("turbo:submit-start", () => {
  //   console.log('turbo:submit-start');
  //   // Alpine.store('loading').loadingModal = true;

  // });

  // フォーム送信完了時
  document.addEventListener("turbo:submit-end", () => {
    // console.log('turbo:submit-end');
    Alpine.store('loading').loadingModal = false;
  });

  // Turbo Frameのレンダリング後
  document.addEventListener("turbo:frame-render", () => {
    // console.log('turbo:frame-render');
    Alpine.store('loading').loadingModal = true;
  });

  // Turbo Frameのロード後
  document.addEventListener("turbo:frame-load", () => {
    // console.log('turbo:frame-load');
    Alpine.store('loading').loadingModal = false;
  });


</script>