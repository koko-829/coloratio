<script>
  const passwordPattern = /^(?=.*?[a-z])(?=.*?\d)[a-zA-Z\d!#$%&@]+$/;
  const passwordAvailable = /^[A-Za-z\d!#$%&@]+$/;
  document.addEventListener('alpine:init', () => {
    Alpine.data('resetPasswordValidation', () => ({
      password: '',
      password_confirmation: '',
      errors: {},
      status_submit: false,

      validatePasswordEmpty() {
        if (!this.password) {
          this.errors.password = "※新しいパスワードを入力してください";
        }
      },

      validatePasswordMinLength() {
        if (this.password.length < 6) {
          this.errors.password = "※6文字以上で設定してください";
        }
      },

      validatePasswordComplexity() {
        if (!passwordAvailable.test(this.password)) {
          this.errors.password = "※英数字・記号(!#$%&@)以外は使用できません";
        } else if (!passwordPattern.test(this.password)) {
          this.errors.password = "※半角英字(a~z)・数字(1~9)がそれぞれ1文字以上必要です";
        }
      },

      validatePasswordRemove() {
        if (this.errors.password === "※新しいパスワードを入力してください" && this.password) {
          delete this.errors.password;
        } else if (this.errors.password === "※6文字以上で設定してください" && this.password.length >= 6) {
          delete this.errors.password;
        } else if (this.errors.password === "※半角英字(a~z)・数字(1~9)がそれぞれ1文字以上必要です" && passwordPattern.test(this.password)) {
          delete this.errors.password;
        } else if (this.errors.password === "※英数字・記号(!#$%&@)以外は使用できません" && passwordAvailable.test(this.password)) {
          delete this.errors.password;
        }
      },

      validateSubmit() {
        if (this.password && this.password.length >= 6 && passwordPattern.test(this.password) && this.password === this.password_confirmation) {
          this.status_submit = true;
        } else {
          this.status_submit = false;
        }
      }

    }));
  });
</script>